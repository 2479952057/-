<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å‘˜å·¥å·¥ä½œæ—¥å¿— - AIæ™ºèƒ½è¯„åˆ†ç³»ç»Ÿ</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:system-ui}
body{background:#f7f8fa}
.container{max-width:1000px;margin:20px auto;padding:0 20px}
.header{background:#1677ff;color:white;padding:18px 20px;border-radius:14px}
.main{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin:20px 0}
.card{background:white;padding:22px;border-radius:14px;box-shadow:0 2px 12px rgba(0,0,0,0.05)}
.card h2{margin-bottom:16px;color:#1677ff}
.form-item{margin-bottom:14px}
label{display:block;margin-bottom:6px}
input,textarea{width:100%;padding:10px;border:1px solid #ddd;border-radius:8px}
textarea{min-height:100px;resize:vertical}
.btn{width:100%;padding:12px;background:#1677ff;color:white;border:none;border-radius:10px;margin-top:10px;font-weight:bold;cursor:pointer;transition:background 0.2s}
.btn:disabled{background:#999;cursor:not-allowed}
.btn:hover:not(:disabled){background:#0d5bcd}
.score-item{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #f0f0f0}
.radar{height:280px;margin:16px 0}
.rank-item{display:flex;justify-content:space-between;padding:10px;border-bottom:1px solid #f2f2f2}
.rank-item:first-child{font-weight:bold;color:#1677ff}
.tips{color:#999;font-size:12px;margin-top:10px;text-align:center}
.status-tip{text-align:center;margin-top:8px;font-size:13px;color:#1677ff}
.key-input{background:#f0f7ff;border:1px solid #1677ff;margin-bottom:16px}
</style>
<script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
</head>
<body>
<div class="container">
  <div class="header">
    <h1>å‘˜å·¥å·¥ä½œæ—¥å¿— - AIæ™ºèƒ½è¯„åˆ†ç³»ç»Ÿ</h1>
  </div>
  <div class="main">
    <div class="card">
      <h2>ğŸ“ å·¥ä½œæ—¥å¿—</h2>
      <!-- å¯†é’¥è¾“å…¥æ¡†ï¼Œä»£ç é‡Œä¸å­˜å¯†é’¥ï¼Œåªæœ‰ä½ è‡ªå·±æ‰‹åŠ¨è¾“å…¥ -->
      <div class="form-item">
        <label>Gemini APIå¯†é’¥ï¼ˆä»…æœ¬åœ°ä½¿ç”¨ï¼Œä¸ä¸Šä¼ ã€ä¸ä¿å­˜ï¼‰</label>
        <input id="apiKey" type="password" class="key-input" placeholder="è¯·è¾“å…¥ä½ è‡ªå·±çš„Gemini APIå¯†é’¥">
      </div>
      <div class="form-item"><label>å§“å</label><input id="name" placeholder="è¯·è¾“å…¥å§“å"></div>
      <div class="form-item"><label>ä»Šæ—¥å®Œæˆå·¥ä½œ</label><textarea id="done" placeholder="è¯·è¯¦ç»†å¡«å†™ä»Šæ—¥å®Œæˆçš„å·¥ä½œå†…å®¹"></textarea></div>
      <div class="form-item"><label>æœªå®Œæˆå·¥ä½œ</label><textarea id="undone" placeholder="è¯·å¡«å†™æœªå®Œæˆçš„å·¥ä½œåŠåŸå› "></textarea></div>
      <div class="form-item"><label>é‡åˆ°çš„é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</label><textarea id="problem" placeholder="è¯·å¡«å†™é‡åˆ°çš„é—®é¢˜åŠå¯¹åº”çš„è§£å†³åŠæ³•"></textarea></div>
      <div class="form-item"><label>æ˜æ—¥å·¥ä½œè®¡åˆ’</label><textarea id="plan" placeholder="è¯·å¡«å†™æ˜æ—¥çš„å·¥ä½œå®‰æ’ä¸è®¡åˆ’"></textarea></div>
      <button class="btn" onclick="submitAI()" id="btn">ğŸš€ AIæ™ºèƒ½è¯„åˆ†</button>
      <div class="tips">æ¥å…¥Google Geminiå®˜æ–¹APIï¼Œçº¯AIçœŸå®è¯„åˆ†ï¼Œå¯†é’¥ä»…æœ¬åœ°ä½¿ç”¨ï¼Œæ°¸ä¸æ³„éœ²</div>
      <div id="statusTip" class="status-tip"></div>
    </div>
    <div class="card">
      <h2>ğŸ“Š AIè¯„åˆ†ç»“æœ</h2>
      <div style="text-align:center;margin:20px 0">
        <div style="font-size:42px;font-weight:bold;color:#00b42a" id="total">0.00</div>
        <div>æ€»åˆ†ï¼ˆ0~4.0ï¼‰</div>
      </div>
      <div class="score-item">å·¥ä½œå®Œæˆåº¦ <b id="s1">0.0</b></div>
      <div class="score-item">æ•ˆç‡ä¸æ‰§è¡ŒåŠ› <b id="s2">0.0</b></div>
      <div class="score-item">è´£ä»»å¿ƒä¸æ€åº¦ <b id="s3">0.0</b></div>
      <div class="score-item">åä½œä¸æ²Ÿé€š <b id="s4">0.0</b></div>
      <div class="score-item">æ”¹è¿›ä¸æˆé•¿ <b id="s5">0.0</b></div>
      <div id="radar" class="radar"></div>
      <p id="comment" style="margin-top:10px;line-height:1.6;color:#333"></p>
    </div>
  </div>
  <div class="card">
    <h2>ğŸ† å‘˜å·¥è¯„åˆ†æ’å</h2>
    <div id="rankList" style="padding:14px;text-align:center;color:#999">æš‚æ— è¯„åˆ†è®°å½•</div>
  </div>
</div>

<script>
// å…¨å±€å˜é‡ï¼Œä»£ç é‡Œå½»åº•ä¸å†™æ­»å¯†é’¥
let chart;
let records = JSON.parse(localStorage.getItem('workScoreRecords')) || [];

// é¡µé¢åŠ è½½åˆå§‹åŒ–
window.onload = () => {
  chart = echarts.init(document.getElementById('radar'));
  updateRadarChart([0, 0, 0, 0, 0]);
  renderRank();
  window.addEventListener('resize', () => chart.resize());
};

// æ›´æ–°é›·è¾¾å›¾
function updateRadarChart(data) {
  chart.setOption({
    radar: {
      indicator: [
        { name: 'å·¥ä½œå®Œæˆåº¦', max: 0.8 },
        { name: 'æ•ˆç‡ä¸æ‰§è¡ŒåŠ›', max: 0.8 },
        { name: 'è´£ä»»å¿ƒä¸æ€åº¦', max: 0.8 },
        { name: 'åä½œä¸æ²Ÿé€š', max: 0.8 },
        { name: 'æ”¹è¿›ä¸æˆé•¿', max: 0.8 }
      ],
      splitNumber: 4
    },
    series: [{
      type: 'radar',
      data: [{
        value: data,
        name: 'è¯„åˆ†ç»´åº¦',
        itemStyle: { color: '#1677ff' },
        areaStyle: { color: 'rgba(22, 119, 255, 0.2)' }
      }]
    }]
  }, true);
}

// æ ¸å¿ƒçº¯AIè¯„åˆ†é€»è¾‘ï¼ˆæ— ä»»ä½•å…œåº•ã€æ— æœ¬åœ°ç”Ÿæˆåˆ†æ•°ä»£ç ï¼‰
async function submitAI() {
  // è·å–è¡¨å•å†…å®¹å’Œæ‰‹åŠ¨è¾“å…¥çš„å¯†é’¥
  const apiKey = document.getElementById('apiKey').value.trim();
  const name = document.getElementById('name').value.trim();
  const done = document.getElementById('done').value.trim();
  const undone = document.getElementById('undone').value.trim();
  const problem = document.getElementById('problem').value.trim();
  const plan = document.getElementById('plan').value.trim();
  const btn = document.getElementById('btn');
  const statusTip = document.getElementById('statusTip');

  // åŸºç¡€æ ¡éªŒ
  if (!apiKey) {
    alert('è¯·è¾“å…¥ä½ çš„Gemini APIå¯†é’¥');
    return;
  }
  if (!name) {
    alert('è¯·å¡«å†™å§“å');
    return;
  }
  if (!done) {
    alert('è¯·å¡«å†™ä»Šæ—¥å®Œæˆå·¥ä½œå†…å®¹');
    return;
  }

  // åŠ¨æ€æ‹¼æ¥å®˜æ–¹APIåœ°å€ï¼Œå¯†é’¥ä»…åœ¨æœ¬åœ°å†…å­˜ä¸­ä½¿ç”¨
  const GEMINI_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${apiKey}`;

  // æŒ‰é’®ç¦ç”¨ï¼Œé˜²æ­¢é‡å¤æäº¤
  btn.disabled = true;
  btn.innerText = "AIè¯„åˆ†ä¸­â€¦";
  statusTip.innerText = "æ­£åœ¨è°ƒç”¨Geminiå®˜æ–¹APIè¯„åˆ†â€¦";

  try {
    // ç»™AIçš„ç²¾å‡†promptï¼Œä¸¥æ ¼è¦æ±‚è¿”å›å›ºå®šæ ¼å¼JSON
    const prompt = `
ä½ æ˜¯ä¸“ä¸šçš„å‘˜å·¥å·¥ä½œè¡¨ç°è¯„åˆ†åŠ©æ‰‹ï¼Œå¿…é¡»ä¸¥æ ¼éµå®ˆä»¥ä¸‹æ‰€æœ‰è§„åˆ™ï¼Œåªè¿”å›çº¯JSONæ ¼å¼æ•°æ®ï¼Œä¸èƒ½æœ‰ä»»ä½•å…¶ä»–å†…å®¹ã€è§£é‡Šã€markdownæ ¼å¼ã€å¤šä½™ç¬¦å·ã€æ¢è¡Œã€‚
è¯„åˆ†è§„åˆ™ï¼š
1.  ä»5ä¸ªç»´åº¦è¯„åˆ†ï¼Œæ¯ä¸ªç»´åº¦åˆ†æ•°èŒƒå›´0.1-0.8ï¼Œä¿ç•™1ä½å°æ•°
    - score1ï¼šå·¥ä½œå®Œæˆåº¦ï¼Œæ ¹æ®ä»Šæ—¥å®Œæˆå·¥ä½œçš„å®Œæ•´æ€§ã€è½åœ°æ€§ã€å·¥ä½œé‡è¯„åˆ†
    - score2ï¼šæ•ˆç‡ä¸æ‰§è¡ŒåŠ›ï¼Œæ ¹æ®å·¥ä½œå®Œæˆçš„æ•ˆç‡ã€é—­ç¯æƒ…å†µã€æ¨è¿›è¿›åº¦è¯„åˆ†
    - score3ï¼šè´£ä»»å¿ƒä¸æ€åº¦ï¼Œæ ¹æ®å·¥ä½œæ€åº¦ã€æœªå®Œæˆå·¥ä½œçš„æ­£è§†ç¨‹åº¦ã€è´Ÿè´£ç¨‹åº¦è¯„åˆ†
    - score4ï¼šåä½œä¸æ²Ÿé€šï¼Œæ ¹æ®å·¥ä½œä¸­çš„ååŒå¯¹æ¥ã€é—®é¢˜æ²Ÿé€šã€è·¨æ–¹é…åˆæƒ…å†µè¯„åˆ†
    - score5ï¼šæ”¹è¿›ä¸æˆé•¿ï¼Œæ ¹æ®å·¥ä½œå¤ç›˜ã€é—®é¢˜è§£å†³ã€æ˜æ—¥è®¡åˆ’çš„åˆç†æ€§ã€æˆé•¿æ€§è¯„åˆ†
2.  totalï¼šæ€»åˆ†ï¼Œå¿…é¡»æ˜¯5ä¸ªç»´åº¦åˆ†æ•°çš„æ€»å’Œï¼Œä¿ç•™2ä½å°æ•°ï¼ŒèŒƒå›´0.5-4.0
3.  commentï¼šè¯„è¯­ï¼Œæ ¹æ®æ•´ä½“å·¥ä½œæƒ…å†µï¼Œå†™ä¸€æ®µ50-150å­—çš„ä¸“ä¸šã€ä¸­è‚¯çš„å·¥ä½œè¯„è¯­
4.  å¿…é¡»ä¸¥æ ¼æ ¹æ®ç”¨æˆ·æäº¤çš„å·¥ä½œæ—¥å¿—å†…å®¹è¯„åˆ†ï¼Œç»å¯¹ä¸èƒ½éšæœºï¼Œå·¥ä½œå†…å®¹è¶Šå®Œæ•´ã€è½åœ°æ€§è¶Šå¼ºã€æ€åº¦è¶Šç«¯æ­£ï¼Œåˆ†æ•°è¶Šé«˜
ç”¨æˆ·æäº¤çš„å·¥ä½œæ—¥å¿—å†…å®¹ï¼š
å§“åï¼š${name}
ä»Šæ—¥å®Œæˆå·¥ä½œï¼š${done}
æœªå®Œæˆå·¥ä½œï¼š${undone}
é‡åˆ°çš„é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆï¼š${problem}
æ˜æ—¥å·¥ä½œè®¡åˆ’ï¼š${plan}
è¿”å›æ ¼å¼å¿…é¡»ä¸¥æ ¼æ˜¯çº¯JSONï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š
{"score1":"0.6","score2":"0.6","score3":"0.6","score4":"0.6","score5":"0.6","total":"3.00","comment":"å·¥ä½œå®Œæˆæƒ…å†µè‰¯å¥½ï¼Œæ‰§è¡ŒåŠ›è¾¾æ ‡ï¼Œæ€åº¦ç«¯æ­£ï¼Œæœ‰å®Œæ•´çš„å·¥ä½œ...
