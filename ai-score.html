<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å‘˜å·¥å·¥ä½œæ—¥å¿— - çœŸAIæ™ºèƒ½è¯„åˆ†ç³»ç»Ÿ</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:system-ui}
body{background:#f7f8fa}
.container{max-width:1000px;margin:20px auto;padding:0 20px}
.header{background:#1677ff;color:white;padding:18px 20px;border-radius:14px}
.main{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin:20px 0}
.card{background:white;padding:22px;border-radius:14px;box-shadow:0 2px 12px #0000000a}
.card h2{margin-bottom:16px;color:#1677ff}
.form-item{margin-bottom:14px}
label{display:block;margin-bottom:6px}
input,textarea{width:100%;padding:10px;border:1px solid #ddd;border-radius:8px}
textarea{min-height:100px}
.btn{width:100%;padding:12px;background:#1677ff;color:white;border:none;border-radius:10px;margin-top:10px;font-weight:bold}
.btn:disabled{background:#999}
.score-item{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #f0f0f0}
.radar{height:280px;margin:16px 0}
.rank-item{display:flex;justify-content:space-between;padding:10px;border-bottom:1px solid #f2f2f2}
</style>
<script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
</head>
<body>

<div class="container">
  <div class="header">
    <h1>å‘˜å·¥å·¥ä½œæ—¥å¿— - çœŸAIæ™ºèƒ½è¯„åˆ†ç³»ç»Ÿ</h1>
  </div>

  <div class="main">
    <div class="card">
      <h2>ğŸ“ å·¥ä½œæ—¥å¿—</h2>
      <div class="form-item"><label>å§“å</label><input id="name"></div>
      <div class="form-item"><label>ä»Šæ—¥å®Œæˆ</label><textarea id="done"></textarea></div>
      <div class="form-item"><label>æœªå®Œæˆ</label><textarea id="undone"></textarea></div>
      <div class="form-item"><label>é—®é¢˜ä¸æ–¹æ¡ˆ</label><textarea id="problem"></textarea></div>
      <div class="form-item"><label>æ˜æ—¥è®¡åˆ’</label><textarea id="plan"></textarea></div>
      <button class="btn" onclick="submitAI()" id="btn">ğŸš€ çœŸAIæ™ºèƒ½è¯„åˆ†</button>
    </div>

    <div class="card">
      <h2>ğŸ“Š AIè¯„åˆ†ç»“æœ</h2>
      <div style="text-align:center;margin:20px 0">
        <div style="font-size:42px;font-weight:bold;color:#00b42a" id="total">0.00</div>
        <div>æ€»åˆ†ï¼ˆ0~4.0ï¼‰</div>
      </div>
      <div class="score-item">å·¥ä½œå®Œæˆåº¦ <b id="s1">0.0</b></div>
      <div class="score-item">æ•ˆç‡ä¸æ‰§è¡ŒåŠ› <b id="s2">0.0</b></div>
      <div class="score-item">è´£ä»»å¿ƒä¸æ€åº¦ <b id="s3">0.0</b></div>
      <div class="score-item">åä½œä¸æ²Ÿé€š <b id="s4">0.0</b></div>
      <div class="score-item">æ”¹è¿›ä¸æˆé•¿ <b id="s5">0.0</b></div>
      <div id="radar" class="radar"></div>
      <p id="comment" style="margin-top:10px;line-height:1.6"></p>
    </div>
  </div>

  <div class="card">
    <h2>ğŸ† æ’å</h2>
    <div id="rankList" style="padding:14px;text-align:center;color:#999">æš‚æ— è®°å½•</div>
  </div>
</div>

<script>
let chart;
let records = [];

window.onload = () => {
  chart = echarts.init(document.getElementById('radar'));
  chart.setOption({
    radar:{indicator:[
      {name:'å·¥ä½œå®Œæˆåº¦',max:0.8},
      {name:'æ•ˆç‡ä¸æ‰§è¡ŒåŠ›',max:0.8},
      {name:'è´£ä»»å¿ƒä¸æ€åº¦',max:0.8},
      {name:'åä½œä¸æ²Ÿé€š',max:0.8},
      {name:'æ”¹è¿›ä¸æˆé•¿',max:0.8}
    ]},
    series:[{type:'radar',data:[{value:[0,0,0,0,0]}]}]
  })
}

async function submitAI(){
  const btn = document.getElementById('btn');
  const name = document.getElementById('name').value.trim();
  const done = document.getElementById('done').value.trim();
  if(!name || !done){ alert('è¯·å¡«å†™å§“å+ä»Šæ—¥å®Œæˆ'); return; }

  btn.disabled = true;
  btn.innerText = "AIè¯„åˆ†ä¸­â€¦";

  try {
    const res = await fetch("https://api.lolimi.cn/API/score-work.php", {
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({
        name, done, undone:document.getElementById('undone').value,
        problem:document.getElementById('problem').value,
        plan:document.getElementById('plan').value
      })
    });

    const data = await res.json();
    if(data.code !== 200) throw new Error("è¯„åˆ†å¤±è´¥");

    showResult(data);
  } catch (e) {
    alert("AIè¯„åˆ†å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ");
  } finally {
    btn.disabled = false;
    btn.innerText = "ğŸš€ çœŸAIæ™ºèƒ½è¯„åˆ†";
  }
}

function showResult(data){
  document.getElementById('s1').innerText = data.score1;
  document.getElementById('s2').innerText = data.score2;
  document.getElementById('s3').innerText = data.score3;
  document.getElementById('s4').innerText = data.score4;
  document.getElementById('s5').innerText = data.score5;
  document.getElementById('total').innerText = data.total;
  document.getElementById('comment').innerText = data.comment;

  chart.setOption({
    series:[{data:[{value:[data.score1,data.score2,data.score3,data.score4,data.score5]}]}]
  });

  records.push({
    name:document.getElementById('name').value.trim(),
    total:data.total,
    ...data
  });

  renderRank();
}

function renderRank(){
  const list = document.getElementById('rankList');
  const sorted = [...records].sort((a,b)=>b.total - a.total);
  if(sorted.length === 0){ list.innerHTML = "æš‚æ— è®°å½•"; return; }

  list.innerHTML = sorted.map((i,k)=>`
    <div class="rank-item">
      <span>${k+1}. ${i.name}</span>
      <span>${i.total}</span>
    </div>
  `).join('');
}
</script>
</body>
</html>